<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<!-- #BeginTemplate "three-column.dwt" -->

<head>
<!-- #BeginEditable "doctitle" -->
<title>GISInternals Support Site</title>
<link href="styles/three-column-layout.css" rel="stylesheet" type="text/css" />
<!-- #EndEditable -->
<!-- #BeginEditable "headsection" -->
<meta content="GISInternals Support Site" name="description" />
<meta content="GISInternals SDK GDAL MapServer" name="keywords" />
<!-- #EndEditable -->
<meta content="text/html; charset=iso-8859-2" http-equiv="Content-Type" />
<meta content="hu-hu" http-equiv="Content-Language" />
<meta content="General" name="rating" />
<meta content="no" http-equiv="imagetoolbar" />
<meta content="Copyright &copy; 2018, Tamas Szekeres, all rights reserved" name="copyright" />
<!-- #BeginEditable "includestyles" -->
<link href="styles/three-column-layout.css" rel="stylesheet" type="text/css" />
<!-- #EndEditable -->
<link rel="shortcut icon" href="favicon.ico"/>
<!-- #BeginEditable "includescripts" -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="scripts/gisinternals.js"></script>
<!-- #EndEditable -->
</head>

<body id="mainbody">

<div id="container">
    <div id="logoback">
	<div id="logoleft">
	<img alt="" src="images/ban-title.png" style="float: right"/>
	</div>
	</div>
	<div id="topmenu">
		<ul>
			<li><a href="index.html" title="Home">Home</a></li>
			<li><a href="aboutgisinternals.html" title="About">About</a></li>
			<li><a href="kb.html" title="Documents">Documents</a></li>
			<li><a href="licensing.html" title="Licensing">Licensing</a></li>
			<li><img class="mailimage" alt="" src="images/sendmail.png" /><a href="mailto:gisinternals@gisinternals.com" title="Send email">Send email</a></li>
			<li><img class="mailimage" width="16" height="16" alt="" src="https://www.blogger.com/favicon.ico" /><a target="_blank" href="http://blog.gisinternals.com" title="WebLog">WebLog</a></li>
		</ul>
	</div>
	<div class="urbangreymenu">
		<!-- #BeginEditable "leftnavigation" -->
		<!--webbot bot="Include" u-include="includes/left-menu.html" tag="BODY" startspan -->

<p class="headerbar"><img src="favicon.ico"/>About</p>
<ul>
<li><a href="aboutgisinternals.html" title="About This Site">About This Site</a></li>
<li><a href="myprofile.html" title="Maintenance">Maintenance</a></li>
<li><a href="sponsors.html" title="Sponsors">Sponsors</a></li>
<li><a href="contact.html" title="Contact Info">Contact Info</a></li>
<li><a href="projects.html" title="Projects">Projects</a></li>
<li><a href="issues.html" title="Issue Tracking">Issue Tracking</a></li>
</ul>
<p class="headerbar"><img src="favicon.ico"/>Downloads</p>
<ul>
<li><a href="release.php" title="Stable Releases">Stable Releases</a></li>
<li><a href="stable.php" title="Stable Branches (daily duilds)">Stable Branches (daily)</a></li>
<li><a href="development.php" title="Development Versions (daily builds)">Development Versions (daily)</a></li>
<li><a href="sdk.php" title="Development Kits">Development Kits</a></li>
<li><a href="archive.php" title="Older Releases">Older Releases</a></li>
<li><a href="mapmanager.html" title="Mapserver MapManager"><img style="padding-left:0px;margin-left:0px" alt="MapManager" src="images/mapmanager.png"/>Mapserver MapManager</a></li>

</ul>

<p class="headerbar"><img src="favicon.ico"/>Build Status</p>
<ul>
<li><a href="status.php" title="Latest Build Status">Latest Build Status</a></li>

</ul>
<p class="headerbar"><img src="favicon.ico"/>Documentation</p>
<ul>
<li><a target="_blank" href="http://www.gisinternals.com/MapManager/" title="MapServer MapManager"><img style="padding-left:0px;margin-left:0px" alt="MapManager" src="images/mapmanager.png"/>MapServer MapManager</a></li>
<li><a href="kb.html" title="Documents">Documents</a></li>
<li><a href="changes.html" title="Change Log">Change Log</a></li>
<li><a href="licensing.html" title="License Information">License Information</a></li>
<li><a href="links.html" title="Related Links">Related Links</a></li>
</ul>
<!--webbot bot="Include" endspan i-checksum="6406" --><!-- #EndEditable --></div>
	<div id="rightnav">
		<!-- #BeginEditable "rightsidebar" -->
		<!--webbot bot="Include" u-include="includes/rightbar-main.html" tag="BODY" startspan -->
<div class="news">
<p class="header"><img src="favicon.ico"/>News</p>

<div class="newssection">
<h2>Events</h2>
<a target="_blank" href="https://2020.europe.foss4g.org/"><img width="130"  src="content-images/foss4g-europe-2020.svg" alt="FOSS4G Europe 2020"/></a>
<br/><br/>
<a target="_blank" href="https://2020.foss4g.org/"><img width="130" alt="FOSS4G 2020" src="content-images/FOS_HeaderLogo_2x.png" /></a>

</div>
<!--div class="newssection">
<a target="_blank" href="http://europe.foss4g.org/2015/"><img width="130"  src="../content-images/foss4ge2015.png" alt="FOSS4G Europe 2015"/></a>
</div-->

<!--div id="support">
<p style="color:green;font-weight:bold">Support GISInternals</p>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_s-xclick"/>
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" name="submit" alt="PayPal - The safer, easier way to pay online!"/>
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1"/>
</form>
</div-->
</div>
<div class="logos">
<a target="_blank" href="http://www.osgeo.org"><img alt="Open Source Geospatial Foundation" width="160" src="content-images/osgeo.png" style="border: 1px solid #C0C0C0;" /></a>
<br/>
<a target="_blank" href="http://www.mapserver.org"><img alt="UMN MapServer" width="160" src="content-images/mapserver.png" style="border: 1px solid #C0C0C0;" /></a>
<br/>
<a target="_blank" href="http://www.gdal.org"><img alt="Geospatial Data Abstraction Library" width="70" src="content-images/gdal.png" style="border: 1px solid #C0C0C0;" /></a>


</div>
<!--webbot bot="Include" endspan i-checksum="35518" --><!-- #EndEditable --></div>
	<div id="content">
		<!-- #BeginEditable "maincontent" -->
		<h1>KB2011022200: Redistribution of the shared C runtime component in Visual C++</h1>
		<p>There have been a couple of issues related to the CRT deployment with the <a href="http://www.gisinternals.com">GISInternals</a> causing the application to fail to run properly, so you might have to keep a couple of things in mind when deploying your application on the target computer. Most of these issues are documented in the related MS articles so refer to these documents for the details.</p>
<h2>1. Mixing dll-s compiled with different compilers/ CRT dependencies</h2>
<p>This scenario is not supported by Microsoft and you should avoid this according to the following article: <a href="http://msdn.microsoft.com/en-us/library/ms235460.aspx">Potential Errors Passing CRT Objects Across DLL Boundaries</a> </p>
		<p>
<em>"When you pass C Run-time (CRT) objects such as file handles, locales, and environment variables into or out of a DLL (function calls across the DLL boundary), unexpected behavior can occur if the DLL, as well as the files calling into the DLL, use different copies of the CRT libraries.<br />
A related problem can occur when you allocate memory (either explicitly with new or malloc, or implicitly with strdup, strstreambuf::str, and so on) and then pass a pointer across a DLL boundary to be freed. This can cause a memory access violation or heap corruption if the DLL and its users use different copies of the CRT libraries."</em> </p>
		<p>
This issue not necessarily cause problems when each dll takes the responsibility to de-allocate the memory it has been allocated within the same dll or executable. However we cannot be certain about this for each dlls deployed along with the <a href="http://vbkto.dyndns.org/sdk/">MapServer and GDAL binary packages</a>, but we should keep this danger out of the door as the packages have been compiled the with the same compiler and CRT setting (/MD). Just make sure you won't mix the dll-s from different packages within your deployment.</p>
<h2>2. Expected locations of the CRT redistributables</h2>
<p>When you build an application in Microsoft Visual Studio, and the application uses the C run-time libraries (CRT), distribute the appropriate CRT DLL from the following list with your application:<br />
<ul><li><em>Msvcr100.dll/Msvcp100.dll for Microsoft Visual C++ 2010</em></li>
<li><em>Msvcr90.dll/Msvcp90.dll for Microsoft Visual C++ 2008</em></li>
<li><em>Msvcr80.dll/Msvcp80.dll for Microsoft Visual C++ 2005</em></li>
<li><em>Msvcr71.dll/Msvcp71.dll for Microsoft Visual C++ .NET 2003 with the Microsoft .NET Framework 1.1</em></li>
</ul>For Microsoft Visual C++ .NET 2003, you should install the CRT DLLs into 
		your application program files directory. You should not install these 
		files into the Windows system directories. For Msvcr80.dll and for 
		Msvcr90.dll, you should install the CRT as Windows side-by-side 
		assemblies. For more information see <a href="http://support.microsoft.com/kb/326922">KB326922</a> and <a href="http://msdn.microsoft.com/en-us/library/ms235299.aspx">Redistributing Visual C++ Files</a>. According to the suggestions above I've copied the msvcrt71 dll-s in the packages compiled with MSVC2003. With regards to the MSVC2005/2008 packages you should probably install the corresponding Visual C++ redistributable (vcredist_) package (or incorporate the msm module in your application installer). Make sure to install the package for your desired platform/architecture (x86 or x64)<br/><br/><a href="http://www.microsoft.com/downloads/details.aspx?familyid=200B2FD9-AE1A-4A14-984D-389C36F85647&displaylang=en">Microsoft Visual C++ 2005 Redistributable Package (x86)</a><br/><a href="http://www.microsoft.com/downloads/details.aspx?familyid=EB4EBE2D-33C0-4A47-9DD4-B9A6D7BD44DA&displaylang=en">Microsoft Visual C++ 2005 Redistributable Package (x64)</a><br/><a href="http://www.microsoft.com/downloads/details.aspx?familyid=A5C84275-3B97-4AB7-A40D-3802B2AF5FC2&displaylang=en">Microsoft Visual C++ 2008 Redistributable Package (x86)</a><br/><a href="http://www.microsoft.com/downloads/details.aspx?familyid=BA9257CA-337F-4B40-8C14-157CFDFFEE4E&displaylang=en">Microsoft Visual C++ 2008 Redistributable Package (x64)</a></p>
<h2>3. Application manifests</h2>
<p>Upon establishing the option of the side-by-side assembly cache (as of Win2003 Server and Windows XP) the binaries (dll-s or executables) should declare their (CRT) dependencies in the <a href="http://msdn.microsoft.com/en-us/library/aa374191%28VS.85%29.aspx">application manifest</a> file. Without this declaration the application is a candidate to have the following error: <a href="http://msdn.microsoft.com/en-us/library/ms235560.aspx">C Run-Time Error R6034</a>. 
<em>"An application manifest is an XML file that describes and identifies the shared and private side-by-side assemblies that an application should bind to at run time. These should be the same assembly versions that were used to test the application. Application manifests may also describe metadata for files that are private to the application. Application manifests should be included as a resource in the application's EXE file or DLL."</em> Fortunately the dlls and executables in the <a href="http://vbkto.dyndns.org/sdk/">MapServer and GDAL binary packages</a> contain these manifests embedded as a resource in the binary files (for MSVC2005/2008). This is not an issue with the packages build with MSVC2003 where the CRT implementation is located is the application directory (see #2 above) and not in the shared assembly cache.<br /><br/>
<em><span class="note">Note:</span> For some reason with Visual Studio 2010 Microsoft has reverted the behaviour to VS2003 and no manifests are generated by default. In these cases the CRT dll-s should be installed along with the applications.</em></p>
<h2>4. Licensing issues</h2>
<p>In general you should have a valid license for a "VC.NET 2003" product to be able to redistribute msvcr71.dll, please refer to the redist.txt file in your 
<em>"Visual"</em> product installation folder which files are allowed to be redistributed. This is not the case with the vcredist_ packages (for VS2005/2008) which are allowed to be installed on a per-user basis within the terms of the corresponding EULA.</p>
		
		<!-- #EndEditable -->
		</div>
	<div id="footer">
		<p>GISInternals | <a href="mailto:gisinternals@gisinternals.com" title="Mail to GISInternals">gisinternals@gisinternals.com</a></p>
		<p>Copyright &copy; 2018 | All Rights Reserved</p>
	</div>
</div>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-13269500-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>

<!-- #EndTemplate -->

</html>
